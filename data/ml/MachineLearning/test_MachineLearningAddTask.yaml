story_description: 添加机器学习任务
server: ml
model: MachineLearning
switch: false
request:
  method: post
  url_path: /ml/add
body:
  taskType: single
  name: 单维度异常检测${AnyRobotNameID}$
  description: 机器学习任务
  status: 1
  level: 2
  scene: 异常检测
  algorithm: sigma
  savedSearchName: AS访问日志
  savedSearchId: 28df455d-f248-1c99-d9d6-63b4f532797c
  search:
    logGroup: fe5b7f96-443a-11e7-a467-000c29253e90
    filters:
      must:
      - '@timestamp':
          from: 1427868506416
          to: 1585721306416
      - arPort: 20089
      must_not: []
    query: "*|bucket datehistorgram(@timestamp) interval=1m timezone='Asia/Shanghai'\
      \ mindoccount=1 as 3|stats count(日志等级.keyword) as 日志等级.keyword_count by 3"
    outline: transform field(日志等级.keyword_count) by 3|distribution normal(日志等级.keyword_count)
      by 3
    sort:
    - '@timestamp': desc
    size: 0
    needFieldList: false
    fit: '*|outlier sigma(FF_日志等级.keyword_count) method=std para=1 windows=1 as result
      by 3'
    preprocess: '*|preprocessing fillna(default_all) value=(avg) by 3'
  monitor:
    searchId: aa
  schedule:
    type: interval
    timeInterval: ''
    timeUnit: ''
    startDateTime: ''
    timeRange: 5
    rangeUnit: Y
    timeLabel: last5Years
  condition: ''
  action:
    type: ''
    emails: []
  notify: ''
testcases:
  TestCase1:
    Description: 正常场景:添加单维度异常检测任务成功
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase2:
    Description: 异常场景:添加单维度异常检测任务重名
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase3:
    Description: 正常场景:单维度异常检测任务告警级别:重要
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase4:
    Description: 正常场景:添加单维度异常检测任务 告警级别:紧急
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase5:
    Description: 正常场景:添加单维度异常检测任务,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase6:
    Description: 正常场景:添加单维度异常检测任务,告警级别:重要,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase7:
    Description: 正常场景:添加单维度异常检测任务,告警级别:紧急,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase8:
    Description: 正常场景:添加多维度异常检测任务成功
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase9:
    Description: 异常场景:添加多维度异常检测任务重名
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase10:
    Description: 正常场景:添加多维度异常检测任务告警级别:重要
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase11:
    Description: 正常场景:添加多维度异常检测任务 告警级别:紧急
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase12:
    Description: 正常场景:添加多维度异常检测任务,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase13:
    Description: 正常场景:添加多维度异常检测任务,告警级别:重要,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase14:
    Description: 正常场景:添加多维度异常检测任务,告警级别:紧急,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase15:
    Description: 正常场景:添加时间序列预测任务成功
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase16:
    Description: 异常场景:添加时间序列预测任务重名
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase17:
    Description: 正常场景:添加多维度异常检测任务告警级别:重要
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase18:
    Description: 正常场景:添加时间序列预测任务 告警级别:紧急
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase19:
    Description: 正常场景:添加多维度异常检测任务,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase20:
    Description: 正常场景:添加时间序列预测任务,告警级别:重要,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase21:
    Description: 正常场景:添加时间序列预测任务,告警级别:紧急,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase22:
    Description: 正常场景:添加根因分析任务成功
    isOperationDb: ''
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase23:
    Description: 异常场景:添加根因分析任务重名
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase24:
    Description: 正常场景:添加根因分析任务告警级别:重要
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase25:
    Description: 正常场景:添加根因分析任务 告警级别:紧急
    isOperationDb: ''
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase26:
    Description: 正常场景:添加根因分析任务,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase27:
    Description: 正常场景:添加根因分析任务,告警级别:重要,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200

  TestCase28:
    Description: 正常场景:添加根因分析任务,告警级别:紧急,状态:禁用
    req_body: ''
    runflag: true
    verify:
      AssertType: 0
      value: 200
